<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="520" viewBox="0 0 1200 520" role="img" aria-label="Flow overview diagram">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0" stop-color="#0b1020"/>
      <stop offset="1" stop-color="#11162a"/>
    </linearGradient>
    <linearGradient id="accent" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0" stop-color="#ff375f"/>
      <stop offset="1" stop-color="#ff9f0a"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="10" stdDeviation="14" flood-color="#000" flood-opacity="0.35"/>
    </filter>
    <style>
      .title { font: 800 20px ui-sans-serif, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial; fill: #fff; }
      .label { font: 650 14px ui-sans-serif, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial; fill: rgba(255,255,255,0.85); }
      .tiny { font: 600 12px ui-sans-serif, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial; fill: rgba(255,255,255,0.65); }
      .mono { font: 650 12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; fill: rgba(255,255,255,0.8); }
    </style>
    <marker id="arrow" viewBox="0 0 10 10" refX="9.2" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="rgba(255,255,255,0.65)"/>
    </marker>
  </defs>

  <rect width="1200" height="520" fill="url(#bg)"/>
  <rect x="0" y="0" width="1200" height="10" fill="url(#accent)"/>

  <text class="title" x="80" y="58">Typical Node-RED flow</text>
  <text class="tiny" x="80" y="84">Sensors publish to per-zone topics; commands go to a dedicated control topic; helper nodes mirror state.</text>

  <!-- Nodes -->
  <g filter="url(#shadow)">
    <!-- Sensors -->
    <rect x="80" y="140" width="260" height="300" rx="18" fill="rgba(255,255,255,0.06)" stroke="rgba(255,255,255,0.14)"/>
    <text class="label" x="110" y="176">Sensors</text>
    <text class="mono" x="110" y="202">topic: house/zone/01</text>
    <text class="mono" x="110" y="226">payload: true/false</text>
    <text class="mono" x="110" y="262">topic: house/zone/02</text>
    <text class="mono" x="110" y="286">payload: true/false</text>
    <text class="mono" x="110" y="322">topic: house/zone/03</text>
    <text class="mono" x="110" y="346">payload: true/false</text>
    <text class="tiny" x="110" y="392">Any topic != controlTopic</text>
  </g>

  <g filter="url(#shadow)">
    <!-- Main node -->
    <rect x="420" y="200" width="360" height="180" rx="18" fill="rgba(255,55,95,0.12)" stroke="rgba(255,55,95,0.55)"/>
    <text class="label" x="450" y="240">AlarmSystemUltimate</text>
    <text class="tiny" x="450" y="266">Zones + delays + bypass + siren + log</text>
    <rect x="450" y="292" width="300" height="56" rx="14" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.16)"/>
    <text class="mono" x="468" y="326">msg.topic === controlTopic</text>
  </g>

  <g filter="url(#shadow)">
    <!-- Commands -->
    <rect x="420" y="140" width="360" height="46" rx="14" fill="rgba(255,159,10,0.14)" stroke="rgba(255,159,10,0.55)"/>
    <text class="label" x="450" y="170">Commands (Inject / MQTT / UI)</text>
  </g>

  <g filter="url(#shadow)">
    <!-- Helpers -->
    <rect x="860" y="140" width="260" height="300" rx="18" fill="rgba(255,255,255,0.06)" stroke="rgba(255,255,255,0.14)"/>
    <text class="label" x="890" y="176">Output-only nodes</text>

    <rect x="890" y="200" width="200" height="56" rx="14" fill="rgba(255,255,255,0.07)" stroke="rgba(255,255,255,0.14)"/>
    <text class="label" x="910" y="234">AlarmUltimateState</text>
    <text class="tiny" x="910" y="252">payload: \"armed\" | \"disarmed\"</text>

    <rect x="890" y="270" width="200" height="56" rx="14" fill="rgba(255,255,255,0.07)" stroke="rgba(255,255,255,0.14)"/>
    <text class="label" x="910" y="304">AlarmUltimateZone</text>
    <text class="tiny" x="910" y="322">payload: true/false (selected)</text>

    <rect x="890" y="340" width="200" height="56" rx="14" fill="rgba(255,255,255,0.07)" stroke="rgba(255,255,255,0.14)"/>
    <text class="label" x="910" y="374">AlarmUltimateSiren</text>
    <text class="tiny" x="910" y="392">payload: true/false</text>
  </g>

  <!-- Arrows -->
  <path d="M340 290H420" stroke="rgba(255,255,255,0.65)" stroke-width="2.2" marker-end="url(#arrow)"/>
  <path d="M600 186V200" stroke="rgba(255,255,255,0.65)" stroke-width="2.2" marker-end="url(#arrow)"/>
  <path d="M780 290H860" stroke="rgba(255,255,255,0.65)" stroke-width="2.2" marker-end="url(#arrow)"/>

  <!-- Footer -->
  <text class="tiny" x="80" y="486">Web tools: /alarm-ultimate/alarm-json-mapper â€¢ /alarm-ultimate/alarm-panel (also embeddable)</text>
</svg>
